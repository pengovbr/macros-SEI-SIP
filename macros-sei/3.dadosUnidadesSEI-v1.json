{
  "Name": "3.dadosUnidadesSEI",
  "CreationDate": "2025-6-16",
  "Commands": [
    {
      "Command": "comment",
      "Target": "Macro para complementar os dados das unidades no SEI.",
      "Value": "PONTO DE PARTIDA: Sistema SEI, Menu \"Administra√ß√£o\" > \"Unidades\" > \"Listar\"",
      "Description": "Como ser√° criada uma array, os valores de linha e coluna come√ßam em [0] e [0]. Para tornar seu uso mais amig√°vel, foram inclu√≠das linha de cabe√ßalho (linha 0) e coluna index (coluna 0). Recomenda√ß√£o: no log, exibir a op√ß√£o \"Echo & Status\"."
    },
    {
      "Command": "csvReadArray",
      "Target": "unidadesSENAPE.csv",
      "Value": "unidades",
      "Description": "Este primeiro comando l√™ os dados do arquivo CSV e os salva em uma estrutura interna da macro. Consulte a documenta√ß√£o de refer√™ncia para instru√ß√µes quanto √† montagem do arquivo CSV."
    },
    {
      "Command": "store",
      "Target": "27",
      "Value": "i",
      "Description": "IMPORTANTE: Este comando indica A PARTIR DE QUAL LINHA do arquivo de refer√™ncia a macro vai ser executada (e, dela, vai at√© o final) Se necess√°rio retomar a execu√ß√£o a partir de um erro, altere este valor para a linha da qual pretende retomar."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${unidades}.length;",
      "Value": "totalLinhas",
      "Description": "Este comando obt√©m a quantidade de linhas da lista que foi importada do arquivo CSV."
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "ok",
      "Description": "Este comando gera a vari√°vel que armazenar√° a quantidade de execu√ß√µes bem-sucedidas da macro."
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "falha",
      "Description": "Este comando gera a vari√°vel que armazenar√° a quantidade de execu√ß√µes mal-sucedidas da macro. (Erros no sistema, n√£o no pr√≥prio UI.Vision)"
    },
    {
      "Command": "comment",
      "Target": "open // https://[URL do SEI]/sei/controlador.php?acao=unidade_listar&infra_item_menu=142",
      "Value": "",
      "Description": "Este comando normalmente √© deixado \"comentado\" (desativado) porque ao final de cada execu√ß√£o, a macro j√° volta para seu ponto de in√≠cio. Logo, n√£o faz sentido recarregar a p√°gina."
    },
    {
      "Command": "while_v2",
      "Target": "${i} < ${totalLinhas}",
      "Value": "",
      "Description": "O comando \"while\" indica que a macro deve executar uma determinada a√ß√£o enquanto uma condi√ß√£o espec√≠fica n√£o for satisfeita. A a√ß√£o √© retomar o cadastro da pr√≥xima linha e a condi√ß√£o, aqui, √© que o valor da linha em execu√ß√£o tem que ser inferior ao total de linhas."
    },
    {
      "Command": "type",
      "Target": "id=txtSiglaUnidade",
      "Value": "${unidades[${i}][2]}",
      "Targets": [
        "id=txtSiglaUnidade",
        "name=txtSiglaUnidade",
        "xpath=//*[@id=\"txtSiglaUnidade\"]",
        "xpath=//input[@id='txtSiglaUnidade']",
        "xpath=//div[2]/input",
        "css=#txtSiglaUnidade"
      ],
      "Description": "Este comando insere a sigla da unidade no campo de busca do SEI."
    },
    {
      "Command": "clickAndWait",
      "Target": "id=btnPesquisar",
      "Value": "",
      "Targets": [
        "id=btnPesquisar",
        "xpath=//*[@id=\"btnPesquisar\"]",
        "xpath=//input[@id='btnPesquisar']",
        "xpath=//div[2]/form/div/input",
        "css=#btnPesquisar"
      ],
      "Description": "Em, seguida, a Macro pesquisa pela sigla informada."
    },
    {
      "Command": "echo",
      "Target": "üîÅ Processando linha ${i}: ${unidades[${i}][3]} (${unidades[${i}][2]})",
      "Value": "blue",
      "Description": "Exibe no log qual unidade est√° sendo cadastrada."
    },
    {
      "Command": "clickAndWait",
      "Target": "xpath=//*[@id=\"divInfraAreaTabela\"]/table/tbody/tr[2]/td[6]/a[2]/img[contains(@title, 'Alterar')]",
      "Value": "",
      "Targets": [
        "xpath=//*[@id=\"divInfraAreaTabela\"]/table/tbody/tr[2]/td[6]/a[2]/img",
        "xpath=//a[2]/img",
        "css=#divInfraAreaTabela > table > tbody > tr.infraTrSelecionada.infraTrClara > td:nth-child(6) > a:nth-child(2) > img"
      ],
      "Description": "Aqui, a Macro clica no bot√£o \"Editar\" referente √† Unidade localizada."
    },
    {
      "Command": "type",
      "Target": "id=txtEmail",
      "Value": "${unidades[${i}][5]}",
      "Targets": [
        "id=txtEmail",
        "name=txtEmail",
        "xpath=//*[@id=\"txtEmail\"]",
        "xpath=//input[@id='txtEmail']",
        "xpath=//div[3]/input",
        "css=#txtEmail"
      ],
      "Description": "Este comando insere o endere√ßo de e-mail da unidade no SEI."
    },
    {
      "Command": "type",
      "Target": "id=txtDescricaoEmail",
      "Value": "${unidades[${i}][3]} - ${unidades[${i}][1]}",
      "Targets": [
        "id=txtDescricaoEmail",
        "name=txtDescricaoEmail",
        "xpath=//*[@id=\"txtDescricaoEmail\"]",
        "xpath=//input[@id='txtDescricaoEmail']",
        "xpath=//div[3]/input[2]",
        "css=#txtDescricaoEmail"
      ],
      "Description": "E este a descri√ß√£o, no formato \"Nome da Unidade\" - \"√ìrg√£o\"."
    },
    {
      "Command": "click",
      "Target": "id=sbmGravarEmail",
      "Value": "",
      "Targets": [
        "id=sbmGravarEmail",
        "name=sbmGravarEmail",
        "xpath=//*[@id=\"sbmGravarEmail\"]",
        "xpath=//input[@id='sbmGravarEmail']",
        "xpath=//div[3]/input[3]",
        "css=#sbmGravarEmail"
      ],
      "Description": "Em seguida, a macro grava o e-mail inserido."
    },
    {
      "Command": "click",
      "Target": "id=imgAlterarContato",
      "Value": "",
      "Description": "Neste comando, a macro abre a modal de edi√ß√£o do contato associado √† unidade."
    },
    {
      "Command": "selectFrame",
      "Target": "index=0",
      "Value": "",
      "Description": "Este comando indica que as a√ß√µes da macro v√£o incidir sobre a modal, e n√£o sobre a janela abaixo dela."
    },
    {
      "Command": "check",
      "Target": "id=chkSinEnderecoAssociado",
      "Value": "on",
      "Description": "Marca a checkbox \"Usar Endere√ßo Associado\", que importa o endere√ßo da pessoa jur√≠dica (√ìrg√£o) √† qual a unidade est√° subordinada."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinEnderecoAssociado",
      "Value": "Usa o endere√ßo associado",
      "Description": "Comando para confirmar que a checkbox foi assinalada."
    },
    {
      "Command": "type",
      "Target": "id=txtTelefoneComercialPJ",
      "Value": "${unidades[${i}][6]}",
      "Description": "Cadastra o telefone comercial associado √† unidade no arquivo CSV."
    },
    {
      "Command": "type",
      "Target": "id=txtSitioInternet",
      "Value": "${unidades[${i}][7]}",
      "Description": "Cadastra o website associado √† unidade no arquivo CSV."
    },
    {
      "Command": "clickAndWait",
      "Target": "name=sbmAlterarContato",
      "Value": "",
      "Description": "Finaliza o cadastramento dos dados do contato associado com o clique no bot√£o \"Salvar\", fechando a modal."
    },
    {
      "Command": "selectWindow",
      "Target": "tab=0",
      "Value": "",
      "Description": "A macro retorna para a janela original, de edi√ß√£o dos dados da unidade."
    },
    {
      "Command": "clickAndWait",
      "Target": "name=sbmAlterarUnidade",
      "Value": "",
      "Targets": [
        "name=sbmAlterarUnidade",
        "xpath=//*[@id=\"divInfraBarraComandosSuperior\"]/button",
        "xpath=//button[@name='sbmAlterarUnidade']",
        "xpath=//div/button",
        "css=#divInfraBarraComandosSuperior > button:nth-child(2)"
      ],
      "Description": "E clica, por fim, em \"Salvar\" novamente. "
    },
    {
      "Command": "verifyElementPresent",
      "Target": "id=btnPesquisar",
      "Value": "",
      "Targets": [
        "id=btnPesquisar",
        "xpath=//*[@id=\"btnPesquisar\"]",
        "xpath=//input[@id='btnPesquisar']",
        "xpath=//div[2]/form/div/input",
        "css=#btnPesquisar"
      ],
      "Description": "Esta etapa √© a confer√™ncia de que o SEI voltou √† tela anterior ap√≥s salvar."
    },
    {
      "Command": "if_v2",
      "Target": "${!StatusOK} == true",
      "Value": "",
      "Description": "E aqui, entra uma regra condicional, com base na verifica√ß√£o acima."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${ok}) + 1;",
      "Value": "ok",
      "Description": "Primeiro, a macro acrescenta + 1 ao valor de \"ok\", ou seja, acrescenta uma execu√ß√£o bem-sucedida √† conta."
    },
    {
      "Command": "echo",
      "Target": "‚úÖ Dados da unidade ${unidades[${i}][3]} (${unidades[${i}][2]}) cadastrados com sucesso.",
      "Value": "green",
      "Description": "E, por meio desta linha, exibe a mensagem de sucesso no log."
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": "caso contr√°rio..."
    },
    {
      "Command": "storeText",
      "Target": "id=divInfraMensagens",
      "Value": "mensagemErro",
      "Description": "A macro armazena a mensagem de erro exibida pelo SEI,"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${falha}) + 1;",
      "Value": "falha",
      "Description": "em seguida, acrescenta + 1 ao valor de \"falha\", ou seja, acrescenta uma execu√ß√£o malsucedida √† conta..."
    },
    {
      "Command": "echo",
      "Target": "‚ùå Falha ao cadastrar os dados da ${unidades[${i}][3]} (${unidades[${i}][2]}). Erro: \"${mensagemErro}\"",
      "Value": "red",
      "Description": "E, ent√£o, por meio desta linha, exibe a mensagem de falha no log."
    },
    {
      "Command": "clickAndWait",
      "Target": "id=btnCancelar",
      "Value": "",
      "Description": "Este clique no bot√£o \"Cancelar\" permite √† macro retornar √† tela anterior para retomar o cadastro."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if-else\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 26 da macro.)"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${i}) + 1;",
      "Value": "i",
      "Description": "Esta linha acrescenta + 1 ao valor de \"i\", que corresponde √† linha a ser lida pela macro at√© chegar ao valor m√°ximo. Ou seja, este √© o comando que faz as itera√ß√µes se repetirem enquanto houver dados a cadastrar."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if-else\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"while\" da linha 8 da macro.)"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${ok}) + Number(${falha});",
      "Value": "total",
      "Description": "Esta fun√ß√£o compila os resultados das execu√ß√µes bem-sucedidas e das falhas."
    },
    {
      "Command": "echo",
      "Target": "üèÅ Carga finalizada: ${total} registros processados, sendo ${ok} com sucesso e ${falha} com erro.",
      "Value": "",
      "Description": "E, por fim, esta linha relata - ao final da execu√ß√£o da macro - quantos registros foram processados, quantos com sucesso e quantos com erro."
    }
  ]
}
