{
  "Name": "8.cargaTiposdeProcesso",
  "CreationDate": "2025-8-12",
  "Commands": [
    {
      "Command": "comment",
      "Target": "Esta macro cadastra Tipos de Processo no SEI a partir de um arquivo CSV. INSTRU√á√ïES:",
      "Value": "Execute a Macro (Play Macro) a partir do sistema SEI > Menu \"Administra√ß√£o\" > \"Tipos de Processo\"",
      "Description": "Recomenda√ß√£o: no log, exibir a op√ß√£o \"Echo & Status\". N√£o deixe de conferir a documenta√ß√£o de refer√™ncia."
    },
    {
      "Command": "csvReadArray",
      "Target": "exemploTiposDeProcesso.csv",
      "Value": "tiposProcesso",
      "Description": "Este primeiro comando l√™ os dados do arquivo CSV e os salva em uma estrutura interna da macro. Consulte a documenta√ß√£o de refer√™ncia para instru√ß√µes quanto √† montagem do arquivo CSV."
    },
    {
      "Command": "store",
      "Target": "1",
      "Value": "i",
      "Description": "IMPORTANTE: Este comando indica A PARTIR DE QUAL LINHA do arquivo de refer√™ncia a macro vai ser executada (e, dela, vai at√© o final) Se necess√°rio retomar a execu√ß√£o a partir de um erro, altere este valor para a linha da qual pretende retomar."
    },
    {
      "Command": "store",
      "Target": "${i}",
      "Value": "linhaInicial",
      "Description": "Salva a linha inicial para calcular o progresso da execu√ß√£o."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${tiposProcesso}.length) - 1;",
      "Value": "totalLinhas",
      "Description": "Este comando obt√©m a quantidade de linhas da lista que foi importada do arquivo CSV."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var d = new Date(); return d.getTime()",
      "Value": "tempoInicio",
      "Description": "Registra o momento inicial da execu√ß√£o."
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "ok",
      "Description": "Este comando gera a vari√°vel que armazenar√° a quantidade de execu√ß√µes bem-sucedidas da macro."
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "falha",
      "Description": "Este comando gera a vari√°vel que armazenar√° a quantidade de execu√ß√µes mal-sucedidas da macro. (Erros no sistema, n√£o no pr√≥prio UI.Vision)"
    },
    {
      "Command": "echo",
      "Target": "üßÆ Iniciando processamento pela linha ${i}, de um total de ${totalLinhas}.",
      "Value": "",
      "Description": "Informa no log o ponto de partida."
    },
    {
      "Command": "while",
      "Target": "${i} <= ${totalLinhas}",
      "Value": "",
      "Description": "O comando \"while\" indica que a macro deve executar uma determinada a√ß√£o enquanto uma condi√ß√£o espec√≠fica n√£o for satisfeita. A a√ß√£o √© retomar o cadastro da pr√≥xima linha e a condi√ß√£o, aqui, √© que o valor da linha em execu√ß√£o tem que ser inferior ao total de linhas."
    },
    {
      "Command": "echo",
      "Target": "üîÅ Processando linha ${i}: Tipo de Processo \"${tiposProcesso[${i}][1]}\".",
      "Value": "blue",
      "Description": "Exibe no log qual Tipo de Processo est√° sendo cadastrado."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var atual = Number(${i}) - Number(${linhaInicial}); var total = Number(${totalLinhas}) - Number(${linhaInicial}) + 1; return Math.floor((atual / total) * 100);",
      "Value": "progresso",
      "Description": "Calcula o progresso relativo, de 0 a 100%."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var d = new Date(); return d.getTime()",
      "Value": "tempoAtual",
      "Description": "Registra o momento de in√≠cio de cada itera√ß√£o da macro."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return (${tempoAtual} - ${tempoInicio}) / (Number(${i}) + 1);",
      "Value": "tempoPorLinha",
      "Description": "Estima o tempo gasto em cada linha da macro."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var tempoEstimado = (Number(${totalLinhas}) - Number(${i})) * Number(${tempoPorLinha}); var min = Math.floor(tempoEstimado / 60000); var seg = Math.round((tempoEstimado % 60000) / 1000); var texto = '~ '; if (min > 0) texto += min + ' minuto' + (min != 1 ? 's' : ''); if (seg > 0 || min == 0) texto += (min > 0 ? ' ' : '') + seg + ' segundo' + (seg != 1 ? 's' : ''); return texto.trim();",
      "Value": "estimativa",
      "Description": "Calcula a estimativa de tempo restante em formato humanizado, considerando minutos e segundos com pluraliza√ß√£o."
    },
    {
      "Command": "if",
      "Target": "${i} > 3",
      "Value": "",
      "Description": "Cria uma condicionante para exibir o tempo restante estimado apenas a partir da 4¬™ execu√ß√£o, quando a estimativa estar√° mais precisa."
    },
    {
      "Command": "echo",
      "Target": "üìà Progresso: ${progresso}% | ‚è≥ Tempo restante estimado: ${estimativa}",
      "Value": "blue",
      "Description": "Conforme condicional acima, exibe o progresso e o tempo restante estimado."
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": "Caso contr√°rio,"
    },
    {
      "Command": "echo",
      "Target": "üìà Progresso: ${progresso}%",
      "Value": "blue",
      "Description": "exibe (nas primeiras 3 linhas) apenas o progresso."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "encerra essa condicionante \"if\" (linha 16)."
    },
    {
      "Command": "clickAndWait",
      "Target": "id=btnNovo",
      "Value": "",
      "Targets": [
        "id=btnNovo",
        "xpath=//*[@id=\"btnNovo\"]",
        "xpath=//button[@id='btnNovo']",
        "xpath=//button[2]",
        "css=#btnNovo"
      ],
      "Description": "Clica no Bot√£o \"Novo Tipo de Processo\""
    },
    {
      "Command": "type",
      "Target": "id=txtNome",
      "Value": "${tiposProcesso[${i}][1]}",
      "Targets": [
        "id=txtNome",
        "name=txtNome",
        "xpath=//*[@id=\"txtNome\"]",
        "xpath=//input[@id='txtNome']",
        "xpath=//div[2]/div/input",
        "css=#txtNome"
      ],
      "Description": "Informa o nome do Tipo de Processo a ser cadastrado"
    },
    {
      "Command": "type",
      "Target": "id=txaDescricao",
      "Value": "${tiposProcesso[${i}][2]}",
      "Targets": [
        "id=txaDescricao",
        "name=txaDescricao",
        "xpath=//*[@id=\"txaDescricao\"]",
        "xpath=//textarea[@id='txaDescricao']",
        "xpath=//textarea",
        "css=#txaDescricao"
      ],
      "Description": "Preenche a descri√ß√£o, se houver, do Tipo de Processo a ser cadastrado."
    },
    {
      "Command": "click",
      "Target": "id=imgLupaAssuntos",
      "Value": "",
      "Targets": [
        "id=imgLupaAssuntos",
        "xpath=//*[@id=\"imgLupaAssuntos\"]",
        "xpath=//img[@id='imgLupaAssuntos']",
        "xpath=//div[2]/div/div/img",
        "css=#imgLupaAssuntos"
      ],
      "Description": "Clica no √≠cone para abrir a modal de sele√ß√£o de assunto sugerido."
    },
    {
      "Command": "selectFrame",
      "Target": "index=0",
      "Value": "",
      "Description": "seleciona essa modal de escolha de assunto."
    },
    {
      "Command": "type",
      "Target": "id=txtPalavrasPesquisaAssuntos",
      "Value": "${tiposProcesso[${i}][3]}",
      "Targets": [
        "id=txtPalavrasPesquisaAssuntos",
        "name=txtPalavrasPesquisaAssuntos",
        "xpath=//*[@id=\"txtPalavrasPesquisaAssuntos\"]",
        "xpath=//input[@id='txtPalavrasPesquisaAssuntos']",
        "xpath=//input[2]",
        "css=#txtPalavrasPesquisaAssuntos"
      ],
      "Description": "Insere o c√≥digo do assunto a ser pesquisado para associar ao tipo de processo."
    },
    {
      "Command": "clickAndWait",
      "Target": "id=btnPesquisar",
      "Value": "",
      "Targets": [
        "id=btnPesquisar",
        "xpath=//*[@id=\"btnPesquisar\"]",
        "xpath=//button[@id='btnPesquisar']",
        "xpath=//div/button",
        "css=#btnPesquisar"
      ],
      "Description": "Pesquisa pelo Assunto digitado."
    },
    {
      "Command": "click",
      "Target": "xpath=//label[contains(@title,\"${tiposProcesso[${i}][3]}\")]",
      "Value": "",
      "Targets": [
        "xpath=//*[@id=\"divInfraSparklingModalClose1753705742000\"]/a/img",
        "xpath=//div[2]/div/div[3]/a/img",
        "css=#divInfraSparklingModalClose1753705742000 > a > img"
      ],
      "Description": "Marca a checkbox correspondente ao assunto selecionado."
    },
    {
      "Command": "click",
      "Target": "id=btnTransportarSelecao",
      "Value": "",
      "Targets": [
        "id=btnTransportarSelecao",
        "xpath=//*[@id=\"btnTransportarSelecao\"]",
        "xpath=//button[@id='btnTransportarSelecao']",
        "xpath=//button[2]",
        "css=#btnTransportarSelecao"
      ],
      "Description": "Transporta o item selecionado para a caixa de assuntos."
    },
    {
      "Command": "click",
      "Target": "id=btnFecharSelecao",
      "Value": "",
      "Targets": [
        "id=btnFecharSelecao",
        "xpath=//*[@id=\"btnFecharSelecao\"]",
        "xpath=//button[@id='btnFecharSelecao']",
        "xpath=//button[3]",
        "css=#btnFecharSelecao"
      ],
      "Description": "Fecha a modal de sele√ß√£o de assuntos."
    },
    {
      "Command": "selectWindow",
      "Target": "tab=0",
      "Value": "",
      "Description": "A macro retorna para a janela original, de edi√ß√£o do Tipo de Processo."
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][4]} != \"\"",
      "Value": "",
      "Description": "Gera uma condicionante que diz que SE o campo referente a restri√ß√£o de tipos de unidade que poder√£o criar processos deste tipo estiver preenchido..."
    },
    {
      "Command": "click",
      "Target": "id=imgLupaOrgaos",
      "Value": "",
      "Description": "a macro deve abrir a modal de sele√ß√£o de √≥rg√£os,"
    },
    {
      "Command": "selectFrame",
      "Target": "index=0",
      "Value": "",
      "Description": "selecionar essa modal para executar os pr√≥ximos comandos,"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${tiposProcesso[${i}][4]}.split(';');",
      "Value": "listaOrgaos",
      "Description": "em seguida, deve transformar os valores separados por ponto e v√≠rgula em uma lista de √≥rg√£os separados."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${listaOrgaos}.length;",
      "Value": "totalOrgaos",
      "Description": "Ent√£o, ela conta quantos √≥rg√£os ser√£o marcados... "
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "idx",
      "Description": "E come√ßa pelo primeiro √≥rg√£o da lista."
    },
    {
      "Command": "while",
      "Target": "${idx} < ${totalOrgaos}",
      "Value": "",
      "Description": "Deve repetir para cada √≥rg√£o,"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${listaOrgaos}[${idx}].trim();",
      "Value": "orgaoAtual",
      "Description": "armazenando, numa vari√°vel, o √≥rg√£o a ser tratado nos pr√≥ximos comandos."
    },
    {
      "Command": "echo",
      "Target": "üîπLimitando a cria√ß√£o de processos do tipo \"${tiposProcesso[${i}][1]}\" ao √≥rg√£o ${orgaoAtual}.",
      "Value": "",
      "Description": "Ent√£o a macro reporta qual √≥rg√£o est√° sendo tratado,"
    },
    {
      "Command": "check",
      "Target": "xpath=//input[@title=\"${orgaoAtual}\" and @type=\"checkbox\"]",
      "Value": "",
      "Targets": [
        "xpath=//*[@id=\"divInfraSparklingModalClose1754417194467\"]/a/img",
        "xpath=//div[2]/div/div[3]/a/img",
        "css=#divInfraSparklingModalClose1754417194467 > a > img"
      ],
      "Description": "marca a checkbox equivalente √† sigla do √≥rg√£o,"
    },
    {
      "Command": "assertChecked",
      "Target": "xpath=//input[@title=\"${orgaoAtual}\" and @type=\"checkbox\"]",
      "Value": "",
      "Description": "e confere se ela de fato foi assinalada."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${idx}) + 1;",
      "Value": "idx",
      "Description": "Com este comando, a macro passa para o pr√≥ximo √≥rg√£o."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"while\", como a utilizada aqui. Ele indica que se encerra uma condi√ß√£o de repeti√ß√£o. Este √© o \"end\" do \"while\" da linha 38 da macro.)"
    },
    {
      "Command": "click",
      "Target": "id=btnTransportarSelecao",
      "Value": "",
      "Description": "Ent√£o, confirma a sele√ß√£o"
    },
    {
      "Command": "click",
      "Target": "id=btnFecharSelecao",
      "Value": "",
      "Description": "e fecha a modal de sele√ß√£o de √≥rg√£o."
    },
    {
      "Command": "selectWindow",
      "Target": "tab=0",
      "Value": "",
      "Description": "Com este comando, a macro retorna para a janela principal,"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 32 da macro.)"
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][5]} != \"\"",
      "Value": "",
      "Description": "E este, confere se h√° restri√ß√£o a unidades espec√≠ficas, dentro de cada √≥rg√£o, para criar processos deste Tipo."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${tiposProcesso[${i}][5]}.split(';');",
      "Value": "listaOrgaosComUnidades",
      "Description": "Este script separa os blocos de √≥rg√£o+unidades, ex: ['ORGAO-A:UNI1|UNI2','ORGAO-B:UNI3|UNI4']"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${listaOrgaosComUnidades}.length;",
      "Value": "totalOrgaosComUnidades",
      "Description": "E este conta quantos blocos (√≥rg√£os) existem para cadastrar."
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "idxOrgao",
      "Description": "O cadastro se inicia no primeiro √≥rg√£o..."
    },
    {
      "Command": "while",
      "Target": "${idxOrgao} < ${totalOrgaosComUnidades}",
      "Value": "",
      "Description": "e deve percorrer todos - este while indica que os comandos deste intervalo v√£o se repetir at√© que as unidades do √∫ltimo √≥rg√£o sejam cadastradas na restri√ß√£o de unidades que podem criar processos deste tipo."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${listaOrgaosComUnidades}[${idxOrgao}].split(':');",
      "Value": "partesOrgao",
      "Description": "Para cada √≥rg√£o, a macro divide √≥rg√£o e unidades: ['ORGAO-A':'UNI1|UNI2']"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${partesOrgao}[0].trim();",
      "Value": "orgaoAtual",
      "Description": "Dessa express√£o, a macro extrai a sigla do √≥rg√£o"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${partesOrgao}[1].split('|');",
      "Value": "listaUnidades",
      "Description": "E, em seguida, a lista de unidades"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${listaUnidades}.length;",
      "Value": "totalUnidades",
      "Description": "E conta quantas unidades neste √≥rg√£o ser√£o cadastradas."
    },
    {
      "Command": "echo",
      "Target": "üîπ Limitando a cria√ß√£o de processos do tipo \"${tiposProcesso[${i}][1]}\" a ${totalUnidades} unidade(s) do √≥rg√£o ${orgaoAtual}.",
      "Value": "blue",
      "Description": "Em seguida, relata qual √≥rg√£o vai configurar e com quantas unidades."
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "idxUnidade",
      "Description": "E determina que deve come√ßar a buscar pela primeira unidade do √≥rg√£o."
    },
    {
      "Command": "select",
      "Target": "id=selOrgaos",
      "Value": "label=${orgaoAtual}",
      "Targets": [
        "xpath=//*[@id=\"selOrgaos\"]/option",
        "xpath=//option[@value='0']",
        "xpath=//div[4]/div/div[2]/select/option",
        "css=#selOrgaos > option:nth-child(1)"
      ],
      "Description": "Seleciona o √≥rg√£o atual na caixa de sele√ß√£o,"
    },
    {
      "Command": "while",
      "Target": "${idxUnidade} < ${totalUnidades}",
      "Value": "",
      "Description": "Percorrendo todas as unidades listadas para esse √≥rg√£o, nesse Tipo de Processo."
    },
    {
      "Command": "click",
      "Target": "id=imgLupaUnidades",
      "Value": "",
      "Description": "E abre modal de sele√ß√£o de unidades a partir desse √≥rg√£o."
    },
    {
      "Command": "selectFrame",
      "Target": "index=0",
      "Value": "",
      "Description": "Seleciona o frame da modal de sele√ß√£o de unidades"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${listaUnidades}[${idxUnidade}].trim();",
      "Value": "unidadeAtual",
      "Description": "Este script pega a sigla da unidade atual"
    },
    {
      "Command": "echo",
      "Target": "üîπLimitando √† unidade ${unidadeAtual} do √≥rg√£o ${orgaoAtual}.",
      "Value": "",
      "Description": "E aqui, a macro explica qual unidade est√° sendo inclu√≠da na restri√ß√£o."
    },
    {
      "Command": "type",
      "Target": "id=txtSiglaUnidade",
      "Value": "${unidadeAtual}",
      "Targets": [
        "id=divInfraSparklingModalClose1754590881979",
        "xpath=//*[@id=\"divInfraSparklingModalClose1754590881979\"]",
        "xpath=//div[@id='divInfraSparklingModalClose1754590881979']",
        "xpath=//div[2]/div/div[3]",
        "css=#divInfraSparklingModalClose1754590881979"
      ],
      "Description": "Este comando digita a sigla da unidade na caixa de busca."
    },
    {
      "Command": "clickAndWait",
      "Target": "id=btnPesquisar",
      "Value": "",
      "Targets": [
        "xpath=//*[@id=\"divInfraSparklingModalClose1754590881979\"]/a/img",
        "xpath=//div[2]/div/div[3]/a/img",
        "css=#divInfraSparklingModalClose1754590881979 > a > img"
      ],
      "Description": "Este comando equivale ao clique no bot√£o \"Pesquisar\""
    },
    {
      "Command": "check",
      "Target": "xpath=//input[contains (@title, \"${unidadeAtual}\")]",
      "Value": "",
      "Description": "E este, em seguida, assinala a unidade na lista de resultados exibidos da busca."
    },
    {
      "Command": "click",
      "Target": "id=btnTransportarSelecao",
      "Value": "",
      "Description": "Em seguida, a macro transporta a unidade selecionada para a caixa de unidades,"
    },
    {
      "Command": "click",
      "Target": "id=btnFecharSelecao",
      "Value": "",
      "Description": "Em seguida, a macro fecha a modal de sele√ß√£o de unidades,"
    },
    {
      "Command": "selectWindow",
      "Target": "tab=0",
      "Value": "",
      "Description": "e volta √† tela principal."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${idxUnidade}) + 1;",
      "Value": "idxUnidade",
      "Description": "e vai para a pr√≥xima unidade da lista, at√© acabar."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"while\", como a utilizada aqui. Ele indica que se encerra uma condi√ß√£o de repeti√ß√£o. Este √© o \"end\" do \"while\" da linha 61 da macro.)"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${idxOrgao}) + 1;",
      "Value": "idxOrgao",
      "Description": "Agora, a macro prossegue para as unidades do pr√≥ximo √≥rg√£o"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"while\", como a utilizada aqui. Ele indica que se encerra uma condi√ß√£o de repeti√ß√£o. Este √© o \"end\" do \"while\" da linha 53 da macro.)"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 49 da macro.)"
    },
    {
      "Command": "store",
      "Target": "${tiposProcesso[${i}][6]}",
      "Value": "niveisAcesso",
      "Description": "Agora a macro deve ler os N√≠veis de Acesso Permitidos - p√∫blico ou restrito - da coluna 6 (PUB, RES, SIG, PUB;RES; RES:SIG ou PUB;RES;SIG etc.)."
    },
    {
      "Command": "executeScript",
      "Target": "return ${niveisAcesso}.includes('PUB');",
      "Value": "temPUB",
      "Description": "Aqui ela cria uma vari√°vel para monitorar se h√° 'PUB' na lista de n√≠veis permitidos."
    },
    {
      "Command": "if",
      "Target": "${temPUB} == true",
      "Value": "",
      "Description": "Se houver 'PUB', ela marca a checkbox de \"P√∫blico\"."
    },
    {
      "Command": "check",
      "Target": "id=chkSinPublicoPermitido",
      "Value": "",
      "Description": "Este comando √© o que assinala a checkbox de n√≠vel de acesso permitido \"P√∫blico\"."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinPublicoPermitido",
      "Value": "",
      "Description": "E este confere se a checkbox de n√≠vel de acesso permitido \"P√∫blico\" foi de fato assinalada."
    },
    {
      "Command": "executeScript",
      "Target": "document.getElementById('optPublicoSugestao').disabled = false;",
      "Value": "",
      "Description": "Este comando ativa o radio button de n√≠vel de acesso sugerido (p√∫blico)."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 79 da macro.)"
    },
    {
      "Command": "executeScript",
      "Target": "return ${niveisAcesso}.includes('RES');",
      "Value": "temRES",
      "Description": "Aqui ela cria uma vari√°vel para monitorar se h√° 'RES' na lista de n√≠veis permitidos."
    },
    {
      "Command": "if",
      "Target": "${temRES} == true",
      "Value": "",
      "Description": "Se houver 'RES', ela marca a checkbox de \"Restrito\"."
    },
    {
      "Command": "check",
      "Target": "id=chkSinRestritoPermitido",
      "Value": "",
      "Description": "Este comando √© o que assinala a checkbox de n√≠vel de acesso permitido \"Restrito\"."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinRestritoPermitido",
      "Value": "",
      "Description": "E este confere se a checkbox de n√≠vel de acesso permitido \"Restrito\" foi de fato assinalada."
    },
    {
      "Command": "executeScript",
      "Target": "document.getElementById('optRestritoSugestao').disabled = false;",
      "Value": "",
      "Description": "Este comando ativa o radio button de n√≠vel de acesso sugerido (restrito)."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 85 da macro.)"
    },
    {
      "Command": "executeScript",
      "Target": "return ${niveisAcesso}.includes('SIG');",
      "Value": "temSIG",
      "Description": "Aqui ela cria uma vari√°vel para monitorar se h√° 'SIG' na lista de n√≠veis permitidos."
    },
    {
      "Command": "if",
      "Target": "${temSIG} == true",
      "Value": "",
      "Description": "Se houver 'RES', ela marca a checkbox de \"Restrito\"."
    },
    {
      "Command": "check",
      "Target": "id=chkSinSigilosoPermitido",
      "Value": "",
      "Description": "Este comando √© o que assinala a checkbox de n√≠vel de acesso permitido \"Restrito\"."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinSigilosoPermitido",
      "Value": "",
      "Description": "E este confere se a checkbox de n√≠vel de acesso permitido \"Restrito\" foi de fato assinalada."
    },
    {
      "Command": "executeScript",
      "Target": "document.getElementById('optSigilosoSugestao').disabled = false;",
      "Value": "",
      "Description": "Este comando ativa o radio button de n√≠vel de acesso sugerido (restrito)."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 91 da macro.)"
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][7]} == \"RES\"",
      "Value": "",
      "Description": "Esta condicional verifica, inicialmente, se o N√≠vel de Acesso sugerido para processos deste tipo (criados via sistemas integrados ou m√≥dulos) √© \"restrito\"."
    },
    {
      "Command": "check",
      "Target": "id=optRestritoSugestao",
      "Value": "",
      "Targets": [
        "id=optRestritoSugestao",
        "name=rdoNivelAcessoSugestao",
        "xpath=//*[@id=\"optRestritoSugestao\"]",
        "xpath=//input[@id='optRestritoSugestao']",
        "xpath=//div[2]/div/fieldset/div[2]/div/input",
        "css=#optRestritoSugestao"
      ],
      "Description": "Se sim, este comando assinala a checkbox de n√≠vel de acesso sugerido \"Restrito\" para sistemas e m√≥dulos."
    },
    {
      "Command": "assertChecked",
      "Target": "id=optRestritoSugestao",
      "Value": "",
      "Description": "E este confere se a checkbox de n√≠vel de acesso sugerido \"Restrito\" foi de fato assinalada."
    },
    {
      "Command": "executeScript",
      "Target": "alterarNivelAcessoSugerido();",
      "Value": "",
      "Description": "Caso o n√≠vel de acesso sugerido seja \"restrito\", este script for√ßa a altera√ß√£o do n√≠vel de acesso (simulando um clique manual), habilitando a escolha de hip√≥tese legal sugerida."
    },
    {
      "Command": "pause",
      "Target": "300",
      "Value": "",
      "Description": "Esta pausa de 0,3 segundos √© necess√°ria para o sistema carregar as hip√≥teses legais ap√≥s o comando anterior."
    },
    {
      "Command": "select",
      "Target": "id=selHipoteseLegal",
      "Value": "label=${tiposProcesso[${i}][9]}",
      "Targets": [
        "id=selHipoteseLegal",
        "name=selHipoteseLegal",
        "xpath=//*[@id=\"selHipoteseLegal\"]",
        "xpath=//select[@id='selHipoteseLegal']",
        "xpath=//div[7]/select",
        "css=#selHipoteseLegal"
      ],
      "Description": "E este comando, por fim, seleciona a hip√≥tese legal indicada no arquivo CSV."
    },
    {
      "Command": "elseif",
      "Target": "${tiposProcesso[${i}][7]} == \"SIG\"",
      "Value": "",
      "Description": "Seguindo a condicional, este comando verifica se o N√≠vel de Acesso sugerido para processos deste tipo (criados via sistemas integrados ou m√≥dulos) √© \"sigiloso\"."
    },
    {
      "Command": "check",
      "Target": "id=optSigilosoSugestao",
      "Value": "",
      "Targets": [
        "id=optRestritoSugestao",
        "name=rdoNivelAcessoSugestao",
        "xpath=//*[@id=\"optRestritoSugestao\"]",
        "xpath=//input[@id='optRestritoSugestao']",
        "xpath=//div[2]/div/fieldset/div[2]/div/input",
        "css=#optRestritoSugestao"
      ],
      "Description": "E este comando √© o que assinala a checkbox de n√≠vel de acesso sugerido \"sigiloso\" para sistemas e m√≥dulos,"
    },
    {
      "Command": "assertChecked",
      "Target": "id=optSigilosoSugestao",
      "Value": "",
      "Description": "E este confere se a checkbox de n√≠vel de acesso sugerido \"Restrito\" foi de fato assinalada."
    },
    {
      "Command": "executeScript",
      "Target": "alterarNivelAcessoSugerido();",
      "Value": "",
      "Description": "Caso o n√≠vel de acesso sugerido seja \"sigiloso\", este script for√ßa a altera√ß√£o do n√≠vel de acesso (simulando um clique manual), habilitando a escolha de hip√≥tese legal sugerida."
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][8]} == \"U\"",
      "Value": "",
      "Description": "Para processos sigilosos, √© necess√°rio indicar o grau de sigilo. Neste caso, esta condicional verifica se o Tipo de Processo tem grau de sigilo sugerido \"Ultrassecreto\"."
    },
    {
      "Command": "select",
      "Target": "id=selGrauSigilo",
      "Value": "label=Ultrassecreto",
      "Targets": [
        "id=selGrauSigilo",
        "name=selGrauSigilo",
        "xpath=//*[@id=\"selGrauSigilo\"]",
        "xpath=//select[@id='selGrauSigilo']",
        "xpath=//div[6]/select",
        "css=#selGrauSigilo"
      ],
      "Description": "Se sim, este comando seleciona o grau \"Ultrassecreto\"."
    },
    {
      "Command": "elseif",
      "Target": "${tiposProcesso[${i}][8]} == \"S\"",
      "Value": "",
      "Description": "Caso contr√°rio, este comando verifica se o grau de sigilo √© \"secreto\"."
    },
    {
      "Command": "select",
      "Target": "id=selGrauSigilo",
      "Value": "label=Secreto",
      "Targets": [
        "id=selGrauSigilo",
        "name=selGrauSigilo",
        "xpath=//*[@id=\"selGrauSigilo\"]",
        "xpath=//select[@id='selGrauSigilo']",
        "xpath=//div[6]/select",
        "css=#selGrauSigilo"
      ],
      "Description": "Se sim, este comando seleciona o grau \"Secreto\"."
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": "Caso n√£o seja nem ultrassecreto, nem secreto,"
    },
    {
      "Command": "select",
      "Target": "id=selGrauSigilo",
      "Value": "label=Reservado",
      "Targets": [
        "id=selGrauSigilo",
        "name=selGrauSigilo",
        "xpath=//*[@id=\"selGrauSigilo\"]",
        "xpath=//select[@id='selGrauSigilo']",
        "xpath=//div[6]/select",
        "css=#selGrauSigilo"
      ],
      "Description": "este comando seleciona o grau de sigilo \"Reservado\""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 106 da macro.)"
    },
    {
      "Command": "pause",
      "Target": "300",
      "Value": "",
      "Description": "Esta pausa de 0,3 segundos √© necess√°ria para o sistema carregar as hip√≥teses legais ap√≥s o comando anterior."
    },
    {
      "Command": "select",
      "Target": "id=selHipoteseLegal",
      "Value": "label=${tiposProcesso[${i}][9]}",
      "Targets": [
        "id=selHipoteseLegal",
        "name=selHipoteseLegal",
        "xpath=//*[@id=\"selHipoteseLegal\"]",
        "xpath=//select[@id='selHipoteseLegal']",
        "xpath=//div[7]/select",
        "css=#selHipoteseLegal"
      ],
      "Description": "E este comando seleciona a hip√≥tese legal indicada no arquivo CSV"
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": "N√£o sendo \"restrito\" ou \"sigiloso\", a macro atribuir√° N√≠vel de Acesso \"p√∫blico\" sugerido para uso padr√£o, quando forem criados processos do Tipo por sistemas integrados ou m√≥dulos."
    },
    {
      "Command": "check",
      "Target": "id=optPublicoSugestao",
      "Value": "",
      "Targets": [
        "id=optPublicoSugestao",
        "name=rdoNivelAcessoSugestao",
        "xpath=//*[@id=\"optPublicoSugestao\"]",
        "xpath=//input[@id='optPublicoSugestao']",
        "xpath=//div[2]/div/fieldset/div[3]/div/input",
        "css=#optPublicoSugestao"
      ],
      "Description": "Este comando √© o que assinala a checkbox de n√≠vel de acesso sugerido \"P√∫blico\" para sistemas e m√≥dulos,"
    },
    {
      "Command": "assertChecked",
      "Target": "id=optPublicoSugestao",
      "Value": "",
      "Description": "E este confere se a checkbox de n√≠vel de acesso sugerido \"P√∫blico\" foi de fato assinalada."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 96 da macro.)"
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][10]} == \"Sim\"",
      "Value": "",
      "Description": "Este comando verifica se o Tipo de Processo √© exclusivo da Ouvidoria."
    },
    {
      "Command": "check",
      "Target": "id=chkSinOuvidoria",
      "Value": "",
      "Description": "Se sim, ele marca a checkbox correspondente."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinOuvidoria",
      "Value": "",
      "Description": "E valida se a checkbox foi marcada."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 100 da macro.)"
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][11]} == \"Sim\"",
      "Value": "",
      "Description": "Este comando verifica se este Tipo de Processo exclusivo da Ouvidoria permite contato an√¥nimo."
    },
    {
      "Command": "check",
      "Target": "id=chkSinOuvidoriaAnonimo",
      "Value": "",
      "Description": "Se sim, ele marca a checkbox correspondente."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinOuvidoriaAnonimo",
      "Value": "",
      "Description": "E valida se a checkbox foi marcada."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 104 da macro.)"
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][12]} == \"Sim\"",
      "Value": "",
      "Description": "Este comando verifica se o Tipo de Processo permite o cadastro de apenas um processo por interessado."
    },
    {
      "Command": "check",
      "Target": "id=chkSinIndividual",
      "Value": "",
      "Description": "Se sim, ele marca a checkbox correspondente."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinIndividual",
      "Value": "",
      "Description": "E valida se a checkbox foi marcada."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 107 da macro.)"
    },
    {
      "Command": "if",
      "Target": "${tiposProcesso[${i}][13]} == \"Sim\"",
      "Value": "",
      "Description": "Este comando verifica se o Tipo de Processo √© interno do Sistema (exclusivo de sistemas integrados e m√≥dulos, inacess√≠vel a usu√°rios humanos)."
    },
    {
      "Command": "check",
      "Target": "id=chkSinInterno",
      "Value": "",
      "Description": "Se sim, ele marca a checkbox correspondente."
    },
    {
      "Command": "assertChecked",
      "Target": "id=chkSinInterno",
      "Value": "",
      "Description": "E valida se a checkbox foi marcada."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma bifurca√ß√£o. Este √© o \"end\" do \"if\" da linha 112 da macro.)"
    },
    {
      "Command": "clickAndWait",
      "Target": "name=sbmCadastrarTipoProcedimento",
      "Value": "",
      "Targets": [
        "name=sbmCadastrarTipoProcedimento",
        "xpath=//*[@id=\"divInfraBarraComandosInferior\"]/button",
        "xpath=//div[3]/button",
        "css=#divInfraBarraComandosInferior > button:nth-child(3)"
      ],
      "Description": "Este comando simula o clique no bot√£o \"Salvar\", gravando o Tipo de Processo cadastrado."
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": "Este comando √© necess√°rio para a valida√ß√£o do if posterior (linha 20)."
    },
    {
      "Command": "verifyElementPresent",
      "Target": "id=btnImprimir",
      "Value": "",
      "Targets": [
        "id=btnImprimir",
        "xpath=//*[@id=\"btnImprimir\"]",
        "xpath=//button[@id='btnImprimir']",
        "xpath=//button[5]",
        "css=#btnImprimir"
      ],
      "Description": "Esta etapa √© a confer√™ncia de que o SIP voltou √† tela anterior ap√≥s salvar."
    },
    {
      "Command": "if",
      "Target": "${!statusOK} == true",
      "Value": "",
      "Description": "Este comando valida se a verifica√ß√£o anterior manteve o status da execu√ß√£o como bem sucedida. Se sim, mensagem de sucesso. Se n√£o, mensagem de erro."
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${ok}) + 1;",
      "Value": "ok",
      "Description": "Primeiro, a macro acrescenta + 1 ao valor de \"ok\", ou seja, acrescenta uma execu√ß√£o bem-sucedida √† conta."
    },
    {
      "Command": "echo",
      "Target": "‚úÖ Tipo de Processo ${tiposProcesso[${i}][1]} cadastrado com sucesso.",
      "Value": "green",
      "Description": "E por meio desta linha, exibe a mensagem de sucesso no log."
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": "caso contr√°rio..."
    },
    {
      "Command": "storeText",
      "Target": "id=divInfraMensagens",
      "Value": "mensagemErro",
      "Description": "a macro armazena a mensagem de erro exibida pelo SIP,"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${falha}) + 1;",
      "Value": "falha",
      "Description": "em seguida, acrescenta + 1 ao valor de \"falha\", ou seja, acrescenta uma execu√ß√£o malsucedida √† conta..."
    },
    {
      "Command": "echo",
      "Target": "‚ùå Falha ao cadastrar o Tipo de Processo ${tiposProcesso[${i}][1]}. Erro: \"${mensagemErro}\"",
      "Value": "red",
      "Description": "E, ent√£o, por meio desta linha, exibe a mensagem de falha no log."
    },
    {
      "Command": "clickAndWait",
      "Target": "id=btnCancelar",
      "Value": "",
      "Description": "Este clique no bot√£o \"Cancelar\" permite √† macro retornar √† tela anterior para retomar o cadastro."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"if\", como a utilizada aqui. Ele indica que se encerra uma valida√ß√£o de uma condi√ß√£o. Este √© o \"end\" do \"if\" da linha 119 da macro.)"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${i}) + 1;",
      "Value": "i",
      "Description": "Esta linha acrescenta + 1 ao valor de \"i\", que corresponde √† linha a ser lida pela macro at√© chegar ao valor m√°ximo. Ou seja, este √© o comando que faz as itera√ß√µes se repetirem enquanto houver dados a cadastrar."
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": "(N√£o √© o fim da macro. Este comando √© padr√£o para opera√ß√µes \"while\", como a utilizada aqui. Ele indica que se encerra uma condi√ß√£o de repeti√ß√£o. Este √© o \"end\" do \"while\" da linha 10 da macro.)"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${ok}) + Number(${falha});",
      "Value": "total",
      "Description": "Esta linha acrescenta + 1 ao valor de \"i\", que corresponde √† linha a ser lida pela macro at√© chegar ao valor m√°ximo. Ou seja, este √© o comando que faz as itera√ß√µes se repetirem enquanto houver dados a cadastrar."
    },
    {
      "Command": "echo",
      "Target": "üèÅ Carga finalizada: ${total} registros processados, sendo ${ok} com sucesso e ${falha} com erro.",
      "Value": "",
      "Description": "E, por fim, esta linha relata - ao final da execu√ß√£o da macro - quantos registros foram processados, quantos com sucesso e quantos com erro."
    }
  ]
}
